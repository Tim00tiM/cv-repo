3 3 3
ABC
abc
A -> a
B -> d
A -> ac
A
4
abc
aaabbb
ababb
ccc